webpackJsonp([18],{Bak3:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("fYFQ"),a=o.n(n),i=(o("Kmkn"),{components:{Treeselect:a.a},data:function(){var t=this;return{columns:[{type:"index",align:"center",title:"序号",width:65},{title:"物品名称",align:"center",key:"name"},{title:"物品编码",align:"center",key:"code"},{title:"物品分类",align:"center",key:"classify"},{title:"品牌",align:"center",key:"brand"},{title:"规格/型号",align:"center",key:"model"},{title:"单位",align:"center",key:"unit"},{title:"入库",align:"center",children:[{title:"数量",key:"inWarehouseNum",align:"center",render:function(e,o){return e("div",[e("span",{style:{textDecoration:"underline",cursor:"pointer"},on:{click:function(){t.showInventoryModal(o.row.id,"1")}}},o.row.inWarehouseNum)])}},{title:"金额",key:"inWarehouseAmount",align:"center"}]},{title:"出库",align:"center",children:[{title:"数量",key:"outWarehouseNum",align:"center",render:function(e,o){return e("div",[e("span",{style:{textDecoration:"underline",cursor:"pointer"},on:{click:function(){t.showInventoryModal(o.row.id,"2")}}},o.row.outWarehouseNum)])}},{title:"金额",key:"outWarehouseAmount",align:"center"}]}],data:[],selectLoading:!1,date:[],dateOptions:this.dateRange,warehouseArr:[],warehouse:"",type:null,typeIdArr:[],name:"",treeOptions:[],startDate:"",endDate:"",normalizer:function(t){return{id:t.id,label:t.name,children:t.children}},inventoryModal:!1,inventoryCols:[{type:"index",title:"序号",align:"center",width:65},{title:"入库单号",align:"center",key:"orderNO",width:140},{title:"入库仓库",align:"center",key:"warehouse"},{title:"入库类型",align:"center",key:"type"},{title:"入库日期",align:"center",key:"date"},{title:"入库数量",align:"center",key:"number",width:90},{title:"单价",align:"center",key:"price",width:65},{title:"金额",align:"center",key:"amount",width:65},{title:"购买人",align:"center",key:"purchaser",width:75},{title:"制单人",align:"center",key:"orderPerson",width:75},{title:"制单日期",align:"center",key:"orderDate"}],inventoryData:[],saveLoading:!1,surplusRecords:0,pageNum:1,pageSize:10,total:"",goodsInfoName:"",title:"",detailId:"",detailType:""}},created:function(){var t=this;this.getChargedStoreRoom().then(function(e){t.warehouseArr=e.data}),this.getKind();var e=new Date,o=new Date;o.setTime(o.getTime()-2592e6),this.date=[o,e];var n=e.toLocaleDateString().split("/"),a=o.toLocaleDateString().split("/");this.endDate=n[0]+"-"+this.fillZero(n[1])+"-"+this.fillZero(n[2]),this.startDate=a[0]+"-"+this.fillZero(a[1])+"-"+this.fillZero(a[2]),this.goodsStatistics(this.startDate,this.endDate,this.warehouse,this.typeIdArr.join(","),this.name)},methods:{changeDate:function(t){this.startDate=t[0],this.endDate=t[1]},onSelect:function(t,e){this.typeIdArr=t},getKind:function(){var t=this;this.treeOptions=[],this.getGoodsKindTree().then(function(e){t.treeOptions=e.data})},showInventoryModal:function(t,e){this.title="1"===e?"入库详情":"出库详情",this.inventoryData=[],this.pageNum=1,this.pageSize=10,this.inventoryModal=!0,this.detailId=t,this.detailType=e,this.goodsStatisticsDetail(this.detailId,this.pageNum,this.pageSize,this.detailType,this.startDate,this.endDate,this.warehouse)},goodsStatisticsDetail:function(t,e,o,n,a,i,s){var r=this;BaseAxios({method:"post",url:"/sr/storeroomData!goodsStatisticsDetail.action",data:{goodsInfoId:t,pageNum:e,pageSize:o,startDate:a,endDate:i,warehouseIds:s,kind:n}}).then(function(t){var e=t.data;r.goodsInfoName=e.goodsInfoName,e&&e.list.length>0&&e.list.map(function(t){r.inventoryData.push({orderNO:t.num,warehouse:t.warehouseName,type:t.intoKind,date:t.date,number:t.count,price:t.unitPrice,amount:t.unitPrice*t.count,purchaser:t.buyName,orderPerson:t.userName,orderDate:t.productDate})}),r.surplusRecords=e.totalCount-r.inventoryData.length}).catch(function(t){r.postErrorTip("请求失败"),console.log(t)})},viewMore:function(){this.pageNum+=1,this.goodsStatisticsDetail(this.detailId,this.pageNum,this.pageSize,this.detailType,this.startDate,this.endDate,this.warehouse)},goodsStatistics:function(t,e,o,n,a){var i=this;this.data=[],BaseAxios({method:"post",url:"/sr/storeroomData!goodsStatistics.action",data:{startDate:t,endDate:e,warehouseIds:o,goodsKindIds:n,goodsName:a}}).then(function(t){var e=t.data;e&&e.length>0&&e.map(function(t){i.data.push({id:t.goodsInfoId,name:t.name,code:t.code,classify:t.goodsKindName,brand:t.brand,model:t.size,unit:t.unit,inWarehouseNum:t.intoCount,inWarehouseAmount:t.intoPrice,outWarehouseNum:t.outCount,outWarehouseAmount:t.outPrice})}),i.total=e.totalRecord,i.selectLoading=!1}).catch(function(t){i.selectLoading=!1,i.postErrorTip("请求失败"),console.log(t)})},selectHandle:function(){this.selectLoading=!0,this.goodsStatistics(this.startDate,this.endDate,this.warehouse,this.typeIdArr.join(","),this.name)},exportHandle:function(){location.href=this.serverPath+"/sr/storeroomData!exportGoodsStatistics.action?warehouseIds="+this.warehouse+"&goodsKindIds="+this.typeIdArr.join(",")+"&goodsName="+this.name+"&startDate="+this.startDate+"&endDate="+this.endDate}},mounted:function(){}}),s=o("W5g0");var r=function(t){o("a+nX")},l=Object(s.a)(i,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"zd-common-component"},[o("div",{staticClass:"zd-common-clearFix"},[o("Button",{staticClass:"zd-common-fl zd-common-pl11 zd-common-pr11 zd-common-mr10",attrs:{type:"primary"},on:{click:t.exportHandle}},[o("Icon",{staticClass:"zd-common-fs18 zd-common-mr5 zd-common-fl",attrs:{type:"ios-open-outline"}}),t._v(" 导出\n    ")],1),t._v(" "),o("div",{staticClass:"zd-common-fr"},[o("DatePicker",{staticClass:"zd-common-input-h38 zd-common-fl zd-common-mr10 zd-cm-w220",attrs:{editable:!1,type:"daterange",options:t.dateOptions,placeholder:"日期"},on:{"on-change":t.changeDate},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),t._v(" "),o("Select",{staticClass:"zd-common-input-h38 zd-common-w200 zd-common-fl zd-common-mr10",attrs:{clearable:!0,placeholder:"全部仓库"},model:{value:t.warehouse,callback:function(e){t.warehouse=e},expression:"warehouse"}},t._l(t.warehouseArr,function(e){return o("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1),t._v(" "),o("div",{staticClass:"zd-common-w300 zd-common-fl zd-common-mr10"},[o("treeselect",{attrs:{multiple:!0,options:t.treeOptions,limit:2,limitText:t.limitHandle,normalizer:t.normalizer,noOptionsText:"暂无数据",clearable:!1,placeholder:"选择物品分类"},on:{close:t.onSelect},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1),t._v(" "),o("Input",{staticClass:"zd-common-input-h38 zd-common-w200 zd-common-fl zd-common-mr10",attrs:{maxlength:50,placeholder:"物品名称"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),t._v(" "),o("Button",{staticClass:"zd-common-fl",attrs:{type:"primary",loading:t.selectLoading},on:{click:t.selectHandle}},[t.selectLoading?o("span",[t._v("正在查询...")]):o("span",[t._v("查询")])])],1)],1),t._v(" "),o("div",{staticClass:"zd-common-mt16"},[o("Table",{ref:"currentRowTable",attrs:{border:"",columns:t.columns,data:t.data}})],1),t._v(" "),o("Modal",{attrs:{"mask-closable":!1,width:1200},model:{value:t.inventoryModal,callback:function(e){t.inventoryModal=e},expression:"inventoryModal"}},[o("h3",{staticClass:"zd-common-modal-header",attrs:{slot:"header"},slot:"header"},[o("span",[t._v(t._s(t.title)+" - "+t._s(t.goodsInfoName))])]),t._v(" "),o("Table",{staticClass:"zd-common-overflow-v",attrs:{border:"",columns:t.inventoryCols,data:t.inventoryData}}),t._v(" "),o("div",{staticClass:"zd-common-tc zd-common-mt20"},[t.surplusRecords>0?o("span",{staticClass:"zd-common-primary-c zd-common-cp zd-common-border-bottom1 zd-common-pl10 zd-common-pr10 zd-common-pb5",on:{click:t.viewMore}},[t._v("\n        还剩"+t._s(t.surplusRecords)+"条记录，继续查看\n        "),o("Icon",{attrs:{type:"ios-arrow-down"}})],1):o("span",{staticClass:"zd-common-border-bottom1 zd-common-pl10 zd-common-pr10 zd-common-pb5"},[t._v("\n        没有更多了\n      ")])]),t._v(" "),o("div",{staticClass:"zd-common-modal-footer zd-common-pt10",attrs:{slot:"footer"},slot:"footer"},[o("Button",{staticClass:"zd-common-w100 zd-common-h32 zd-common-lh8",on:{click:function(e){t.inventoryModal=!1}}},[t._v("取消")])],1)],1)],1)},[],!1,r,"data-v-96f02658",null);e.default=l.exports},"a+nX":function(t,e){}});
//# sourceMappingURL=18.24150e918f35ad6f1250.js.map