webpackJsonp([31],{wE7m:function(t,e){},wOtr:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});o("+RvV");var a={data:function(){var t=this;return{columns:[{type:"index",align:"center",title:"序号",width:65},{title:"调拨单号",align:"center",key:"orderNO"},{title:"调拨日期",align:"center",key:"date"},{title:"转出仓库",align:"center",key:"outWarehouse"},{title:"转入仓库",align:"center",key:"inWarehouse"},{title:"制单人",align:"center",key:"orderPerson"},{title:"制单日期",align:"center",key:"orderDate"},{title:"操作",align:"center",key:"action",width:260,render:function(e,o){return o.row.canEdit?e("div",[e("Button",{props:{type:"primary",ghost:!0},style:{height:"28px",padding:"0 15px 1px",marginRight:"10px"},on:{click:function(){t.showViewModal(o.row.id)}}},"查看"),e("Button",{props:{type:"primary",ghost:!0},style:{height:"28px",padding:"0 15px 1px",marginRight:"10px"},on:{click:function(){t.showModifyModal(o.row.id)}}},"修改"),e("Button",{props:{type:"error",ghost:!0},style:{height:"28px",padding:"0 15px 1px"},on:{click:function(){t.showDelModal(o.row.id)}}},"删除")]):e("div",[e("Button",{props:{type:"primary",ghost:!0},style:{height:"28px",padding:"0 15px 1px"},on:{click:function(){t.showViewModal(o.row.id)}}},"查看")])}}],data:[],pageSize:10,pageNum:1,total:0,saveLoading:!1,goodsCols:[{type:"index",title:"序号",align:"center",width:65},{title:"物品名称",align:"center",key:"name"},{title:"物品编码",align:"center",key:"code"},{title:"物品分类",align:"center",key:"classify"},{title:"品牌",align:"center",key:"brand"},{title:"规格/型号",align:"center",key:"model"},{title:"单位",align:"center",key:"unit",width:65},{title:"出库数量",align:"center",key:"number"},{title:"金额",align:"center",key:"amount"}],goodsData:[{name:"电池",code:"xm5hdc",classify:"办公",brand:"南孚",model:"p34",unit:"个",number:3,amount:360}],viewModal:!1,allDetail:{},delModal:!1,deleteForm:{reason:""},delId:"",dateOptions:this.dateRange,startDate:"",endDate:"",warehouseArr:[],inWarehouse:"",outWarehouse:"",orderNO:"",selectLoading:!1}},created:function(){var t=this;this.getTransfersRecordPage(this.pageNum,this.pageSize,this.startDate,this.endDate,this.inWarehouse,this.outWarehouse,this.orderNO),this.getChargedStoreRoom().then(function(e){t.warehouseArr=e.data})},methods:{printHandle:function(){this.$print(this.$refs.print)},changeDate:function(t){this.startDate=t[0],this.endDate=t[1]},toAddOrder:function(){this.$router.push({path:"/addAllocationOrder"})},showViewModal:function(t){this.viewModal=!0,this.getTransfersRecordInfo(t)},getTransfersRecordInfo:function(t){var e=this;this.goodsData=[],BaseAxios({method:"post",url:"/sr/storeroomData!getTransfersRecordInfo.action",data:{id:t}}).then(function(t){var o=t.data;e.allDetail=o,o.goodsList.map(function(t){e.goodsData.push({name:t.goodsInfoName,code:t.code,classify:t.goodsKindName,brand:t.brand,model:t.size,unit:t.unit,number:t.goodsNum,amount:t.totalPrice})})}).catch(function(t){e.postErrorTip("请求失败"),console.log(t)})},showModifyModal:function(t){this.$router.push({path:"/editAllocationOrder/"+t})},handleSummary:function(t){var e=t.columns,o=t.data,a={};return e.forEach(function(t,e){var s=t.key;if(0!==e){var n=o.map(function(t){return Number(t[s])});if(n.every(function(t){return isNaN(t)})||7!==e&&8!==e)a[s]={key:s,value:""};else{var i=n.reduce(function(t,e){var o=Number(e);return isNaN(o)?t:t+e},0);a[s]={key:s,value:i}}}else a[s]={key:s,value:"合计"}}),a},showDelModal:function(t){this.delModal=!0,this.delId=t,this.deleteForm.reason=""},deleteTransfersRecord:function(t,e){var o=this;BaseAxios({method:"post",url:"/sr/storeroomData!deleteTransfersRecord.action",data:{id:t,deleteCause:e}}).then(function(t){var e=t.data;""!==e&&o.postWarningTip(e),o.saveLoading=!1,o.getTransfersRecordPage(o.pageNum,o.pageSize,o.startDate,o.endDate,o.inWarehouse,o.outWarehouse,o.orderNO)}).catch(function(t){o.saveLoading=!1,o.postErrorTip("请求失败"),console.log(t)})},handleSubmit:function(){this.saveLoading=!0,this.delModal=!1,this.deleteTransfersRecord(this.delId,this.deleteForm.reason)},getTransfersRecordPage:function(t,e,o,a,s,n,i){var r=this;this.data=[],BaseAxios({method:"post",url:"/sr/storeroomData!getTransfersRecordPage.action",data:{pageNum:t,pageSize:e,startDate:o,endDate:a,intoStoreroomId:s,outStoreroomId:n,num:i}}).then(function(t){var e=t.data;e&&e.list.length>0&&e.list.map(function(t){r.data.push({id:t.id,orderNO:t.num,date:t.date,outWarehouse:t.outWarehouse,inWarehouse:t.intohouse,orderPerson:t.user,orderDate:t.productDate,canEdit:t.canEdit})}),r.total=e.totalCount,r.selectLoading=!1}).catch(function(t){r.selectLoading=!1,r.postErrorTip("请求失败"),console.log(t)})},changePage:function(t){this.pageNum=t,this.getTransfersRecordPage(this.pageNum,this.pageSize,this.startDate,this.endDate,this.inWarehouse,this.outWarehouse,this.orderNO)},changePageSize:function(t){this.pageSize=t,this.getTransfersRecordPage(this.pageNum,this.pageSize,this.startDate,this.endDate,this.inWarehouse,this.outWarehouse,this.orderNO)},selectHandle:function(){this.selectLoading=!0,this.getTransfersRecordPage(this.pageNum,this.pageSize,this.startDate,this.endDate,this.inWarehouse,this.outWarehouse,this.orderNO)}},mounted:function(){}},s=o("W5g0");var n=function(t){o("wE7m")},i=Object(s.a)(a,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"zd-common-component"},[o("div",{staticClass:"zd-common-clearFix"},[o("Button",{staticClass:"zd-common-fl zd-common-pl11 zd-common-pr11 zd-common-mr10 zd-cm-res-fl",attrs:{type:"primary","custom-icon":"zd-common-icon-add"},on:{click:t.toAddOrder}},[t._v("\n      调拨单\n    ")]),t._v(" "),o("div",{staticClass:"zd-common-fr zd-cm-res-fr"},[o("DatePicker",{staticClass:"zd-common-input-h38 zd-common-fl zd-common-mr10 zd-cm-w220",attrs:{editable:!1,type:"daterange",options:t.dateOptions,placeholder:"日期"},on:{"on-change":t.changeDate}}),t._v(" "),o("Select",{staticClass:"zd-common-input-h38 zd-common-w150 zd-common-fl zd-common-mr10",attrs:{clearable:"",placeholder:"转入仓库"},model:{value:t.inWarehouse,callback:function(e){t.inWarehouse=e},expression:"inWarehouse"}},t._l(t.warehouseArr,function(e){return o("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1),t._v(" "),o("Select",{staticClass:"zd-common-input-h38 zd-common-w150 zd-common-fl zd-common-mr10",attrs:{clearable:"",placeholder:"转出仓库"},model:{value:t.outWarehouse,callback:function(e){t.outWarehouse=e},expression:"outWarehouse"}},t._l(t.warehouseArr,function(e){return o("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1),t._v(" "),o("Input",{staticClass:"zd-common-input-h38 zd-common-w150 zd-common-fl zd-common-mr10",attrs:{maxlength:50,placeholder:"调拨单号"},model:{value:t.orderNO,callback:function(e){t.orderNO=e},expression:"orderNO"}}),t._v(" "),o("Button",{staticClass:"zd-common-fl",attrs:{type:"primary",loading:t.selectLoading},on:{click:t.selectHandle}},[t.selectLoading?o("span",[t._v("正在查询...")]):o("span",[t._v("查询")])])],1)],1),t._v(" "),o("div",{staticClass:"zd-common-mt16"},[o("Table",{ref:"currentRowTable",attrs:{border:"",columns:t.columns,data:t.data}}),t._v(" "),o("div",{staticClass:"zd-common-tc zd-common-mt20"},[o("Page",{attrs:{total:t.total,current:t.pageNum,"page-size":t.pageSize,"show-sizer":"","show-elevator":"","show-total":""},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}})],1)],1),t._v(" "),o("Modal",{staticClass:"print",attrs:{"mask-closable":!1,width:1100},model:{value:t.viewModal,callback:function(e){t.viewModal=e},expression:"viewModal"}},[o("h3",{staticClass:"zd-common-modal-header",attrs:{slot:"header"},slot:"header"},[o("span",[t._v("查看调拨单")])]),t._v(" "),o("div",{staticClass:"zd-common-clearFix"},[o("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("调拨单号："),o("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.num))])]),t._v(" "),o("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("调拨日期："),o("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.date))])]),t._v(" "),o("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("转出仓库："),o("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.outWarehouseName))])]),t._v(" "),o("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("转入仓库："),o("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.intoWarehouseName))])])]),t._v(" "),o("div",{staticClass:"zd-common-h300 zd-common-mt10"},[o("vue-scroll",[o("Table",{attrs:{border:"",columns:t.goodsCols,data:t.goodsData,"summary-method":t.handleSummary,"show-summary":""}})],1)],1),t._v(" "),o("div",{staticClass:"zd-common-mt10 zd-common-clearFix"},[o("span",{staticClass:"zd-common-fl"},[t._v("制单人："+t._s(t.allDetail.userName))]),o("span",{staticClass:"zd-common-fl zd-common-ml20"},[t._v("制单日期："+t._s(t.allDetail.productDate))])]),t._v(" "),o("div",{staticClass:"zd-common-mt10 zd-common-clearFix"},[o("span",{staticClass:"zd-common-clearFix"},[o("span",{staticClass:"zd-common-fl"},[t._v("备注：")]),o("span",{staticClass:"zd-common-fl zd-cm-remark"},[t._v(t._s(t.allDetail.note))])])]),t._v(" "),o("div",{staticClass:"zd-common-modal-footer zd-common-pt10",attrs:{slot:"footer"},slot:"footer"},[o("Button",{staticClass:"zd-common-mr35 zd-common-w100 zd-common-h32 zd-common-lh8",attrs:{type:"primary"},on:{click:t.printHandle}},[t._v("打印")]),t._v(" "),o("Button",{staticClass:"zd-common-w100 zd-common-h32 zd-common-lh8",on:{click:function(e){t.viewModal=!1}}},[t._v("取消")])],1)]),t._v(" "),o("Modal",{attrs:{"mask-closable":!1,width:590},model:{value:t.delModal,callback:function(e){t.delModal=e},expression:"delModal"}},[o("h3",{staticClass:"zd-common-modal-header",attrs:{slot:"header"},slot:"header"},[o("span",[t._v("删除调拨单")])]),t._v(" "),o("Alert",{staticClass:"zd-common-warning-c",attrs:{type:"warning","show-icon":""}},[t._v("删除后调拨单中的物品将从转入仓库中减少且同时增加到转出仓库，是否确认删除？")]),t._v(" "),o("Form",{ref:"deleteForm",attrs:{model:t.deleteForm}},[o("FormItem",{staticClass:"zd-common-mb0",attrs:{label:"删除原因："}},[o("Input",{staticClass:"zd-common-fl",attrs:{placeholder:"",maxlength:100,type:"textarea",autosize:{minRows:3,maxRows:3}},model:{value:t.deleteForm.reason,callback:function(e){t.$set(t.deleteForm,"reason","string"==typeof e?e.trim():e)},expression:"deleteForm.reason"}})],1)],1),t._v(" "),o("div",{staticClass:"zd-common-modal-footer zd-common-pt10",attrs:{slot:"footer"},slot:"footer"},[o("Button",{staticClass:"zd-common-mr35 zd-common-w100 zd-common-h32 zd-common-lh8",attrs:{type:"primary",loading:t.saveLoading},on:{click:t.handleSubmit}},[t.saveLoading?o("span",[t._v("正在保存...")]):o("span",[t._v("确定")])]),t._v(" "),o("Button",{staticClass:"zd-common-w100 zd-common-h32 zd-common-lh8",on:{click:function(e){t.delModal=!1}}},[t._v("取消")])],1)],1)],1)},[],!1,n,"data-v-36a2f8e0",null);e.default=i.exports}});
//# sourceMappingURL=31.bd7582545abc6c63e517.js.map