webpackJsonp([25],{"/nJ1":function(t,o){},TcMm:function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n={data:function(){return{columns:[{type:"index",align:"center",title:"序号",width:65},{title:"物品名称",align:"center",key:"name"},{title:"物品编码",align:"center",key:"code"},{title:"物品分类",align:"center",key:"classify"},{title:"品牌",align:"center",key:"brand"},{title:"规格/型号",align:"center",key:"model"},{title:"单位",align:"center",key:"unit"},{title:"所属仓库",align:"center",key:"warehouse"},{title:"当前库存",align:"center",key:"currentInventory"},{title:"实际库存",align:"center",key:"actualInventory",slot:"actualInventory"},{title:"盘亏数量",align:"center",key:"lossNum",render:function(t,o){return"1"===o.row.status?t("div",[t("span",{style:{color:"red"}},o.row.lossNum)]):"2"===o.row.status?t("div",[t("span",{style:{color:"green"}},o.row.lossNum)]):t("div",[t("span",{},o.row.lossNum)])}},{title:"状态",align:"center",key:"statusName"}],checkOrderForm:{attrData:[]},pageSize:10,pageNum:1,total:0,warehouse:"",warehouseArr:[],status:[],goodsName:"",selectLoading:!1,warehouseName:"",warehouseNameTmp:"",saveTime:"",totalNum:"",finishNum:"",notFinishNum:"",saveLoading:!1,isFinish:!1}},created:function(){this.getWarehouseInfoByRecordId(this.$route.params.id)},methods:{lossesHandle:function(){this.$router.push({path:"/createOutOrderByCheck/"+this.warehouse})},surplusHandle:function(){this.$router.push({path:"/createPutInOrderByCheck/"+this.warehouse})},getWarehouseInfoByRecordId:function(t){var o=this;BaseAxios({method:"post",url:"/sr/storeroomData!getWarehouseInfoByRecordId.action",data:{id:t}}).then(function(t){var e=t.data;o.warehouseArr=e,o.warehouse=e[0].id,o.warehouseName=e[0].name,o.getInventoryGoodsInfo(o.warehouse.split("_")[0],o.status.join(","),o.goodsName)}).catch(function(t){o.postErrorTip("请求失败"),console.log(t)})},changeWarehouse:function(t){this.warehouseNameTmp=t.label},getInventoryGoodsInfo:function(t,o,e){var n=this;this.checkOrderForm.attrData=[],BaseAxios({method:"post",url:"/sr/storeroomData!getInventoryGoodsInfo.action",data:{id:t,statuses:o,goodsInfoName:e}}).then(function(t){var o=t.data;n.saveTime=o.dateTime,n.totalNum=o.goodsInfoTotalNum,n.finishNum=o.finishNum,n.notFinishNum=o.notFinishNum,n.isFinish=n.totalNum===n.finishNum,o.list.map(function(t){n.checkOrderForm.attrData.push({id:t.id,name:t.name,code:t.code,classify:t.goodsKindName,brand:t.brand,model:t.size,unit:t.unit,warehouse:t.warehouseName,currentInventory:t.inventory,actualInventory:t.actualInventory?t.actualInventory:null,lossNum:t.inventoryNum,statusName:t.statusName,status:t.status})}),n.selectLoading=!1}).catch(function(t){n.selectLoading=!1,n.postErrorTip("请求失败"),console.log(t)})},saveInventoryGoodsInfo:function(t,o,e){var n=this,a={};a.id=t,a.status=e,o.map(function(t,o){a["outGoodsVOs["+o+"].count"]="1"===e?t.currentInventory:null===t.actualInventory?"":t.actualInventory,a["outGoodsVOs["+o+"].recordGoodsId"]=t.id}),BaseAxios({method:"post",url:"/sr/storeroomData!saveInventoryGoodsInfo.action",data:a}).then(function(t){n.$Spin.hide(),n.saveLoading=!1,n.getInventoryGoodsInfo(n.warehouse.split("_")[0],n.status.join(","),n.goodsName)}).catch(function(t){n.postErrorTip("请求失败"),console.log(t)})},saveHandle:function(t){var o=this;this.$refs.checkOrderForm.validate(function(e){e&&("1"===t?o.$Spin.show({render:function(t){return t("div",[t("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),t("div","正在保存...")])}}):o.saveLoading=!0,o.saveInventoryGoodsInfo(o.warehouse.split("_")[0],o.checkOrderForm.attrData,t))})},changePage:function(t){this.pageNum=t},changePageSize:function(t){this.pageSize=t},selectHandle:function(){this.warehouseName=this.warehouseNameTmp,this.selectLoading=!0,this.getInventoryGoodsInfo(this.warehouse.split("_")[0],this.status.join(","),this.goodsName)},exportHandle:function(){location.href=this.serverPath+"/sr/storeroomData!exportInventoryGoodsInfo.action?id="+this.warehouse.split("_")[0]+"&statuses="+this.status.join(",")+"&goodsInfoName="+this.goodsName}},mounted:function(){}},a=e("W5g0");var s=function(t){e("/nJ1")},r=Object(a.a)(n,function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"zd-common-component"},[e("div",{staticClass:"zd-common-clearFix"},[t.isFinish?t._e():e("Button",{staticClass:"zd-common-fl zd-common-pl11 zd-common-pr11 zd-common-mr10 zd-cm-res-fl",attrs:{type:"primary",loading:t.saveLoading},on:{click:function(o){return t.saveHandle("0")}}},[t.selectLoading?e("span",[e("Icon",{staticClass:"zd-common-fs18 zd-common-mr5 zd-common-fl",attrs:{type:"ios-film-outline"}}),t._v("保存中...")],1):e("span",[e("Icon",{staticClass:"zd-common-fs18 zd-common-mr5 zd-common-fl",attrs:{type:"ios-film-outline"}}),t._v("保存")],1)]),t._v(" "),e("Button",{staticClass:"zd-common-fl zd-common-pl11 zd-common-pr11 zd-common-mr10 zd-cm-res-fl",attrs:{type:"primary"},on:{click:function(o){return t.saveHandle("1")}}},[e("Icon",{staticClass:"zd-common-fs18 zd-common-mr5 zd-common-fl",attrs:{type:"ios-checkmark-circle-outline"}}),t._v("盘点完成\n    ")],1),t._v(" "),e("Button",{staticClass:"zd-common-fl zd-common-pl11 zd-common-pr11 zd-common-mr10 zd-cm-res-fl",attrs:{type:"primary"},on:{click:t.exportHandle}},[e("Icon",{staticClass:"zd-common-fs18 zd-common-mr5 zd-common-fl",attrs:{type:"ios-open-outline"}}),t._v("导出\n    ")],1),t._v(" "),e("Button",{staticClass:"zd-common-fl zd-common-pl11 zd-common-pr11 zd-common-mr10 zd-cm-res-fl",attrs:{type:"primary"},on:{click:t.lossesHandle}},[e("Icon",{staticClass:"zd-common-fs18 zd-common-mr5 zd-common-fl",attrs:{type:"ios-trending-down"}}),t._v("盘亏\n    ")],1),t._v(" "),e("Button",{staticClass:"zd-common-fl zd-common-pl11 zd-common-pr11 zd-common-mr10 zd-cm-res-fl",attrs:{type:"primary"},on:{click:t.surplusHandle}},[e("Icon",{staticClass:"zd-common-fs18 zd-common-mr5 zd-common-fl",attrs:{type:"ios-trending-up"}}),t._v("盘盈\n    ")],1),t._v(" "),e("div",{staticClass:"zd-common-fr zd-cm-res-fr"},[e("Select",{staticClass:"zd-common-input-h38 zd-common-w200 zd-common-fl zd-common-mr10",attrs:{placeholder:"全部仓库","label-in-value":!0},on:{"on-change":t.changeWarehouse},model:{value:t.warehouse,callback:function(o){t.warehouse=o},expression:"warehouse"}},t._l(t.warehouseArr,function(o){return e("Option",{key:o.id,attrs:{value:o.id}},[t._v(t._s(o.name))])}),1),t._v(" "),e("Select",{staticClass:"zd-common-input-h38 zd-common-w250 zd-common-fl zd-common-mr10",attrs:{multiple:"",placeholder:"全部状态","max-tag-count":2},model:{value:t.status,callback:function(o){t.status=o},expression:"status"}},[e("Option",{attrs:{value:"0"}},[t._v("正常")]),t._v(" "),e("Option",{attrs:{value:"1"}},[t._v("盘盈")]),t._v(" "),e("Option",{attrs:{value:"2"}},[t._v("盘亏")]),t._v(" "),e("Option",{attrs:{value:"3"}},[t._v("未盘点")])],1),t._v(" "),e("Input",{staticClass:"zd-common-input-h38 zd-common-w150 zd-common-fl zd-common-mr10",attrs:{placeholder:"物品名称"},model:{value:t.goodsName,callback:function(o){t.goodsName=o},expression:"goodsName"}}),t._v(" "),e("Button",{staticClass:"zd-common-fl",attrs:{type:"primary",loading:t.selectLoading},on:{click:t.selectHandle}},[t.selectLoading?e("span",[t._v("正在查询...")]):e("span",[t._v("查询")])])],1)],1),t._v(" "),e("div",{staticClass:"zd-common-mt16"},[e("div",{staticClass:"zd-common-mt16 zd-cm-tip-b"},[t._v("当前选中"+t._s(t.warehouseName)+"，物品总量："),e("span",{staticClass:"zd-common-primary-c"},[t._v(t._s(t.totalNum))]),t._v("，已盘点物品："),e("span",{staticClass:"zd-common-primary-c"},[t._v(t._s(t.finishNum))]),t._v("，未盘点物品："),e("span",{staticClass:"zd-common-primary-c"},[t._v(t._s(t.notFinishNum))]),e("span",{staticClass:"zd-common-fr"},[t._v(t._s(t.isFinish?"盘点完成时间":"保存时间")+"："+t._s(t.saveTime)+" ")])]),t._v(" "),e("Form",{ref:"checkOrderForm",staticClass:"zd-common-mt5",attrs:{model:t.checkOrderForm}},[e("Table",{ref:"currentRowTable",attrs:{border:"",columns:t.columns,data:t.checkOrderForm.attrData},scopedSlots:t._u([{key:"actualInventory",fn:function(o){var n=o.row,a=o.index;return["3"===n.status?e("Form-item",{staticClass:"zd-common-mt24",attrs:{prop:"attrData."+a+".actualInventory"}},[e("InputNumber",{attrs:{max:100,min:1,precision:0,placeholder:"实际库存"},model:{value:t.checkOrderForm.attrData[a].actualInventory,callback:function(o){t.$set(t.checkOrderForm.attrData[a],"actualInventory",o)},expression:"checkOrderForm.attrData[index].actualInventory"}})],1):e("Form-item",{staticClass:"zd-common-mt24"},[e("span",[t._v(t._s(n.actualInventory))])])]}}])})],1)],1)])},[],!1,s,"data-v-55aa158a",null);o.default=r.exports}});
//# sourceMappingURL=25.b62c5837e02192ec06f8.js.map