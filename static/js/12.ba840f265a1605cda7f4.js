webpackJsonp([12],{Pvvq:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});e("+RvV");var o={data:function(){return{startDate:"",endDate:"",dateOptions:this.dateRange,statusArr:[],status:"",numOrName:"",dateRangeArr:[],statisticsDetail:{},isNeedConfirm:!1,columns:[],data:[],pageSize:10,pageNum:1,total:0,selectLoading:!1,viewModal:!1,viewCols:[{type:"index",title:"序号",align:"center",width:70},{title:"物品名称",align:"center",key:"goodsInfoName"},{title:"物品编码",align:"center",key:"code"},{title:"物品分类",align:"center",key:"goodsKindName"},{title:"品牌",align:"center",key:"brand"},{title:"规格/型号",align:"center",key:"size"},{title:"单位",align:"center",key:"unit"},{title:"数量",align:"center",key:"goodsNum"},{title:"价格",align:"center",key:"totalPrice"},{title:"金额",align:"center",key:"totalPrice"}],viewData:[],allDetail:{},confirmModal:!1,saveLoading:!1,signId:"",signOrderNO:"",visible:!1,uploadPicUrl:"",signForm:{uploadId:""},ruleValidate:{uploadId:[{required:!0,message:"请选择文件",trigger:"blur"}]},uploadList:[]}},created:function(){var t=new Date;this.startDate=t.getFullYear()+"-01-01",this.endDate=t.getFullYear()+"-"+this.fillZero(t.getMonth()+1)+"-"+this.fillZero(t.getDate()),this.dateRangeArr=[this.startDate,this.endDate],this.getProvideGoodsView(this.startDate,this.endDate)},methods:{changeDate:function(t){this.startDate=t[0],this.endDate=t[1]},getProvideGoodsPage:function(t,a,e,o,s,n){var i=this;this.data=[],BaseAxios({method:"post",url:"/sr/storeroomData!getProvideGoodsPage.action",data:{pageNum:t,pageSize:a,startDate:e,endDate:o,status:s,num:n}}).then(function(t){var a=t.data;a&&a.list.length>0&&a.list.map(function(t){i.data.push({id:t.id,outStockOrder:t.num,outStockDate:t.date,goodsName:t.name,goodsCode:t.goodsCode,classify:t.goodsKind,brand:t.brand,model:t.size,unit:t.unit,number:t.count,amount:t.price,status:t.price,signFlag:t.signFlag})}),i.total=a.totalCount,i.selectLoading=!1}).catch(function(t){i.selectLoading=!1,i.postErrorTip("请求失败"),console.log(t)})},changePage:function(t){this.pageNum=t,this.getProvideGoodsPage(this.pageNum,this.pageSize,this.startDate,this.endDate,this.status,this.numOrName)},changePageSize:function(t){this.pageSize=t,this.getProvideGoodsPage(this.pageNum,this.pageSize,this.startDate,this.endDate,this.status,this.numOrName)},selectHandle:function(){this.selectLoading=!0,this.getProvideGoodsPage(this.pageNum,this.pageSize,this.startDate,this.endDate,this.status,this.numOrName)},getProvideGoodsView:function(t,a){var e=this;BaseAxios({method:"post",url:"/sr/storeroomData!getProvideGoodsDetail.action",data:{startDate:t,endDate:a}}).then(function(t){var a=t.data;e.statisticsDetail=a,e.needSign=a.needSign,a.needSign?e.columns=[{type:"index",align:"center",title:"序号",width:65},{title:"出库单号",align:"center",key:"outStockOrder",width:140},{title:"出库日期",align:"center",key:"outStockDate"},{title:"物品名称",align:"center",key:"goodsName"},{title:"物品编码",align:"center",key:"goodsCode"},{title:"物品分类",align:"center",key:"classify"},{title:"品牌",align:"center",key:"brand"},{title:"规格/型号",align:"center",key:"model"},{title:"单位",align:"center",key:"unit"},{title:"数量",align:"center",key:"number"},{title:"金额",align:"center",key:"amount"},{title:"收货状态",align:"center",key:"status",render:function(t,a){return a.row.signFlag?t("div",[t("span",{},"已确认")]):t("div",[t("span",{},"未确认")])}},{title:"操作",align:"center",key:"action",render:function(t,a){return a.row.signFlag?t("div",[t("Button",{props:{type:"primary",ghost:!0},style:{height:"28px",padding:"0 15px 1px"},on:{click:function(){e.showDetail(a.row.id)}}},"查看")]):t("div",[t("Button",{props:{type:"primary",ghost:!0},style:{height:"28px",padding:"0 15px 1px"},on:{click:function(){e.showConfirm(a.index)}}},"确认")])}}]:e.columns=[{type:"index",align:"center",title:"序号",width:65},{title:"出库单号",align:"center",key:"outStockOrder"},{title:"出库日期",align:"center",key:"outStockDate"},{title:"物品名称",align:"center",key:"goodsName"},{title:"物品编码",align:"center",key:"goodsCode"},{title:"物品分类",align:"center",key:"classify"},{title:"品牌",align:"center",key:"brand"},{title:"规格/型号",align:"center",key:"model"},{title:"单位",align:"center",key:"unit"},{title:"数量",align:"center",key:"number"},{title:"金额",align:"center",key:"amount"}],e.getProvideGoodsPage(e.pageNum,e.pageSize,e.startDate,e.endDate,e.status,e.numOrName)}).catch(function(t){e.postErrorTip("请求失败"),console.log(t)})},showDetail:function(t){this.viewModal=!0,this.getOutWarehouseRecordInfo(t)},getOutWarehouseRecordInfo:function(t){var a=this;BaseAxios({method:"post",url:"/sr/storeroomData!getOutWarehouseRecordInfo.action",data:{id:t}}).then(function(t){var e=t.data;a.allDetail=e,a.viewData=e.goodsList}).catch(function(t){a.postErrorTip("请求失败"),console.log(t)})},downloadSignPic:function(t){location.href=this.serverPath+t},showConfirm:function(t){this.signForm.uploadId="",this.confirmModal=!0,this.signOrderNO=this.data[t].putInOrder,this.signId=this.data[t].id,this.uploadList=[],this.getOutWarehouseRecordInfo(this.signId)},handleSuccess:function(t,a){this.signForm.uploadId=t.id,a.url=this.serverPath+"/sr/storeroomData!showTempPic.action?attachmentId="+t.id,this.uploadList=[a],this.$refs.signForm.validate()},handleFormatError:function(t){this.postWarningTip("图片格式错误")},handleMaxSize:function(t){this.postWarningTip("最多上传2M大小的图片")},handleView:function(t){this.uploadPicUrl=t,this.visible=!0},handleRemove:function(){this.uploadList=[],this.signForm.uploadId=""},signSubmit:function(t){var a=this;this.$refs[t].validate(function(t){t&&(a.confirmModal=!1,a.saveLoading=!0,a.signOutWarehouseRecord(a.signId,a.signForm.uploadId))})},signOutWarehouseRecord:function(t,a){var e=this;BaseAxios({method:"post",url:"/sr/storeroomData!signOutWarehouseRecord.action",data:{id:t,attIds:a}}).then(function(t){e.saveLoading=!1,e.getProvideGoodsPage(e.pageNum,e.pageSize,e.startDate,e.endDate,e.status,e.numOrName)}).catch(function(t){e.saveLoading=!1,e.postErrorTip("请求失败"),console.log(t)})}},mounted:function(){}},s=e("W5g0");var n=function(t){e("TSSL")},i=Object(s.a)(o,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"zd-common-component"},[e("div",{staticClass:"zd-common-clearFix"},[e("div",{staticClass:"zd-common-fr"},[e("DatePicker",{staticClass:"zd-common-input-h38 zd-cm-w220 zd-common-fl zd-common-mr10",attrs:{editable:!1,type:"daterange",options:t.dateOptions,placeholder:"日期"},on:{"on-change":t.changeDate},model:{value:t.dateRangeArr,callback:function(a){t.dateRangeArr=a},expression:"dateRangeArr"}}),t._v(" "),e("Select",{staticClass:"zd-common-input-h38 zd-common-w200 zd-common-fl zd-common-mr10",attrs:{placeholder:"全部状态",clearable:""},model:{value:t.status,callback:function(a){t.status=a},expression:"status"}},[e("Option",{attrs:{value:"0"}},[t._v("已确认")]),t._v(" "),e("Option",{attrs:{value:"1"}},[t._v("未确认")])],1),t._v(" "),e("Input",{staticClass:"zd-common-input-h38 zd-common-w200 zd-common-fl zd-common-mr10",attrs:{placeholder:"出库单号/物品名称"},model:{value:t.numOrName,callback:function(a){t.numOrName=a},expression:"numOrName"}}),t._v(" "),e("Button",{staticClass:"zd-common-fl",attrs:{type:"primary",loading:t.selectLoading},on:{click:t.selectHandle}},[t.selectLoading?e("span",[t._v("正在查询...")]):e("span",[t._v("查询")])])],1)]),t._v(" "),e("div",{staticClass:"zd-common-mt16 zd-cm-tip-b"},[e("Icon",{staticClass:"zd-common-primary-c",attrs:{type:"md-stats"}}),t._v("\n    "+t._s(t.startDate+"~"+t.endDate)+" 期间，申领物品种类："),e("span",{staticClass:"zd-common-primary-c"},[t._v(t._s(t.statisticsDetail.goodsNum)+"\n    ")]),t._v("个，申领物品数量："),e("span",{staticClass:"zd-common-primary-c"},[t._v(t._s(t.statisticsDetail.goodsCnt))]),t._v("个，申领物品金额："),e("span",{staticClass:"zd-common-primary-c"},[t._v(t._s(t.statisticsDetail.totalPrice))]),t._v("元\n  ")],1),t._v(" "),e("div",{staticClass:"zd-common-mt16"},[e("Table",{ref:"currentRowTable",attrs:{border:"",columns:t.columns,data:t.data}}),t._v(" "),e("div",{staticClass:"zd-common-tc zd-common-mt20"},[e("Page",{attrs:{total:t.total,current:t.pageNum,"page-size":t.pageSize,"show-sizer":"","show-elevator":"","show-total":""},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}})],1)],1),t._v(" "),e("Modal",{ref:"print",attrs:{"mask-closable":!1,width:920},model:{value:t.viewModal,callback:function(a){t.viewModal=a},expression:"viewModal"}},[e("h3",{staticClass:"zd-common-modal-header no-print",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("查看出库单")])]),t._v(" "),e("div",{staticClass:"zd-common-h400"},[e("vue-scroll",[e("div",{staticClass:"zd-common-clearFix"},[e("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("出库单号："),e("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.num))])]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("出库日期："),e("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.date))])]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("出库类型："),e("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.kindCode))])]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("部门："),e("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.departmentName))])]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("领用人："),e("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.buyserName))])])]),t._v(" "),e("Table",{staticClass:"zd-common-mt10",attrs:{border:"",columns:t.viewCols,data:t.viewData,"show-summary":""}}),t._v(" "),e("div",{staticClass:"zd-common-mt10 zd-common-clearFix"},[e("span",{staticClass:"zd-common-fl"},[t._v("制单人："+t._s(t.allDetail.userName))]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-common-ml20"},[t._v("制单日期："+t._s(t.allDetail.productDate))])]),t._v(" "),e("div",{staticClass:"zd-common-mt10 zd-common-clearFix"},[e("span",{staticClass:"zd-common-clearFix"},[e("span",{staticClass:"zd-common-fl"},[t._v("备注：")]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-cm-remark"},[t._v(t._s(t.allDetail.note))])])]),t._v(" "),e("div",{staticClass:"zd-common-mt10 zd-common-clearFix zd-common-primary-c"},[e("span",{staticClass:"zd-common-clearFix"},[e("span",{staticClass:"zd-common-fl"},[t._v("确认时间：")]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-cm-remark"},[t._v(t._s(t.allDetail.productDate))])])]),t._v(" "),e("div",{staticClass:"zd-common-mt10 zd-common-clearFix zd-common-primary-c"},[e("span",{staticClass:"zd-common-clearFix"},[e("span",{staticClass:"zd-common-fl zd-common-cp",on:{click:function(a){return t.downloadSignPic(t.allDetail.url)}}},[t._v("查看签字图片")])])])],1)],1),t._v(" "),e("div",{staticClass:"zd-common-modal-footer no-print",attrs:{slot:"footer"},slot:"footer"},[e("Button",{staticClass:"zd-common-w100 zd-common-h32 zd-common-lh8",on:{click:function(a){t.viewModal=!1}}},[t._v("取消")])],1)]),t._v(" "),e("Modal",{ref:"print",attrs:{"mask-closable":!1,width:920},model:{value:t.confirmModal,callback:function(a){t.confirmModal=a},expression:"confirmModal"}},[e("h3",{staticClass:"zd-common-modal-header no-print",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("确认出库单物品")])]),t._v(" "),e("div",{staticClass:"zd-cm-tip-b"},[e("Icon",{staticClass:"zd-common-primary-c",attrs:{type:"md-stats"}}),t._v("\n      待确认物品来自以下出库单，点击确定将同步确认此出库单所有出库物品！\n    ")],1),t._v(" "),e("div",{staticClass:"zd-common-h400 zd-common-mt10"},[e("vue-scroll",[e("div",{staticClass:"zd-common-clearFix"},[e("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("出库单号："),e("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.num))])]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("出库日期："),e("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.date))])]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("出库类型："),e("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.kindCode))])]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("部门："),e("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.departmentName))])]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("领用人："),e("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.buyserName))])])]),t._v(" "),e("Table",{staticClass:"zd-common-mt10",attrs:{border:"",columns:t.viewCols,data:t.viewData,"show-summary":""}}),t._v(" "),e("div",{staticClass:"zd-common-mt10 zd-common-clearFix"},[e("span",{staticClass:"zd-common-fl"},[t._v("制单人："+t._s(t.allDetail.userName))]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-common-ml20"},[t._v("制单日期："+t._s(t.allDetail.productDate))])]),t._v(" "),e("div",{staticClass:"zd-common-mt10 zd-common-clearFix"},[e("span",{staticClass:"zd-common-clearFix"},[e("span",{staticClass:"zd-common-fl"},[t._v("备注：")]),t._v(" "),e("span",{staticClass:"zd-common-fl zd-cm-remark"},[t._v(t._s(t.allDetail.note))])])]),t._v(" "),e("Form",{ref:"signForm",staticClass:"zd-common-w200 zd-common-mt10",attrs:{model:t.signForm,rules:t.ruleValidate,"label-width":100,"label-position":"left"}},[e("FormItem",{attrs:{prop:"uploadId"}},[e("span",{staticClass:"zd-common-fs14",attrs:{slot:"label"},slot:"label"},[t._v("签字图片：")]),t._v(" "),t._l(t.uploadList,function(a){return e("div",{staticClass:"demo-upload-list zd-common-w150"},["finished"===a.status?[e("img",{attrs:{src:a.url}}),t._v(" "),e("div",{staticClass:"demo-upload-list-cover"},[e("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(e){return t.handleView(a.url)}}}),t._v(" "),e("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(a){return t.handleRemove(a)}}})],1)]:[a.showProgress?e("Progress",{attrs:{percent:a.percentage,"hide-info":""}}):t._e()]],2)}),t._v(" "),e("Upload",{ref:"upload",staticClass:"zd-common-w150 zd-common-auto",attrs:{name:"filedata","show-upload-list":!1,format:["jpg","jpeg","png"],type:"drag",action:t.serverPath+"/component/attachment!saveUploadFile2.action","max-size":2048,"on-success":t.handleSuccess,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize}},[e("Button",{staticClass:"zd-common-w150",attrs:{type:"primary"}},[t._v("上传签字图片")])],1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.signForm.uploadId,expression:"signForm.uploadId"}],attrs:{type:"text",hidden:""},domProps:{value:t.signForm.uploadId},on:{input:function(a){a.target.composing||t.$set(t.signForm,"uploadId",a.target.value)}}}),t._v(" "),e("Modal",{attrs:{width:60},model:{value:t.visible,callback:function(a){t.visible=a},expression:"visible"}},[e("h3",{staticClass:"zd-common-modal-header",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("预览签字")])]),t._v(" "),e("vue-scroll",[e("div",{staticClass:"zd-common-font-size-base zd-common-lh30 zd-common-tc zd-common-h500"},[t.visible?e("img",{staticStyle:{"max-width":"100%"},attrs:{src:t.uploadPicUrl}}):t._e()])]),t._v(" "),e("div",{staticClass:"zd-common-modal-footer zd-common-pt0",attrs:{slot:"footer"},slot:"footer"})],1)],2)],1),t._v(" "),e("p",{staticClass:"zd-common-fs12 zd-common-des-font-c"},[t._v("允许上传png、jpg、jpeg格式图片")])],1)],1),t._v(" "),e("div",{staticClass:"zd-common-modal-footer no-print",attrs:{slot:"footer"},slot:"footer"},[e("Button",{staticClass:"zd-common-w100 zd-common-h32 zd-common-lh8",attrs:{type:"primary",loading:t.selectLoading},on:{click:function(a){return t.signSubmit("signForm")}}},[t.selectLoading?e("span",[t._v("正在保存...")]):e("span",[t._v("确认")])])],1)])],1)},[],!1,n,null,null);a.default=i.exports},TSSL:function(t,a){}});
//# sourceMappingURL=12.ba840f265a1605cda7f4.js.map