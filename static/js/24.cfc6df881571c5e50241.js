webpackJsonp([24],{M0L2:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});o("+RvV");var a={data:function(){var t=this;return{columns:[{type:"index",align:"center",title:"序号",width:65},{title:"入库单号",align:"center",key:"putInOrder"},{title:"入库日期",align:"center",key:"putInDate"},{title:"入库类型",align:"center",key:"putInType"},{title:"入库仓库",align:"center",key:"warehouse"},{title:"供应商",align:"center",key:"supplier"},{title:"物品数量",align:"center",key:"number"},{title:"制单人",align:"center",key:"orderPerson"},{title:"制单日期",align:"center",key:"orderDate"},{title:"操作",align:"center",key:"action",width:260,render:function(e,o){return o.row.canEdit?e("div",[e("Button",{props:{type:"primary",ghost:!0},style:{height:"28px",padding:"0 15px 1px",marginRight:"10px"},on:{click:function(){t.showViewModal(o.row.id)}}},"查看"),e("Button",{props:{type:"primary",ghost:!0},style:{height:"28px",padding:"0 15px 1px",marginRight:"10px"},on:{click:function(){t.showModifyModal(o.row.id)}}},"修改"),e("Button",{props:{type:"error",ghost:!0},style:{height:"28px",padding:"0 15px 1px"},on:{click:function(){t.showDelModal(o.row.id)}}},"删除")]):e("div",[e("Button",{props:{type:"primary",ghost:!0},style:{height:"28px",padding:"0 15px 1px",marginRight:"10px"},on:{click:function(){t.showViewModal(o.row.id)}}},"查看")])}}],data:[],pageSize:10,pageNum:1,total:0,saveLoading:!1,goodsCols:[{type:"index",title:"序号",align:"center",width:65},{title:"物品名称",align:"center",key:"name"},{title:"物品编码",align:"center",key:"code"},{title:"物品分类",align:"center",key:"classify"},{title:"品牌",align:"center",key:"brand"},{title:"规格/型号",align:"center",key:"model"},{title:"单位",align:"center",key:"unit",width:65},{title:"入库数量",align:"center",key:"number"},{title:"价格",align:"center",key:"price"},{title:"金额",align:"center",key:"amount"}],goodsData:[],viewModal:!1,allDetail:{},delModal:!1,deleteForm:{reason:""},delId:"",dateOptions:this.dateRange,startDate:"",endDate:"",type:"",typeArr:[],supplier:"",supplierArr:[],warehouse:"",warehouseArr:[],orderNO:"",selectLoading:!1}},created:function(){var t=this;this.getIntoKindList().then(function(e){t.typeArr=e.data}),this.getGoodsSupplierAllEnable().then(function(e){t.supplierArr=e.data}),this.getChargedStoreRoom().then(function(e){t.warehouseArr=e.data}),this.getIntoWarehouseRecordPage(this.pageNum,this.pageSize,this.startDate,this.endDate,this.type,this.warehouse,this.supplier,this.orderNO)},methods:{printHandle:function(){this.$print(this.$refs.print)},changeDate:function(t){this.startDate=t[0],this.endDate=t[1]},handleSummary:function(t){var e=t.columns,o=t.data,a={};return e.forEach(function(t,e){var n=t.key;if(0!==e){var s=o.map(function(t){return Number(t[n])});if(s.every(function(t){return isNaN(t)})||7!==e&&9!==e)a[n]={key:n,value:""};else{var i=s.reduce(function(t,e){var o=Number(e);return isNaN(o)?t:t+e},0);a[n]={key:n,value:i}}}else a[n]={key:n,value:"合计"}}),a},toAddOrder:function(){this.$router.push({path:"/addPutInOrder"})},showViewModal:function(t){this.viewModal=!0,this.getIntoWarehouseRecordInfo(t)},getIntoWarehouseRecordInfo:function(t){var e=this;this.goodsData=[],BaseAxios({method:"post",url:"/sr/storeroomData!getIntoWarehouseRecordInfo.action",data:{id:t}}).then(function(t){var o=t.data;e.allDetail=o,o.goodsList.map(function(t){e.goodsData.push({name:t.name,code:t.code,classify:t.goodsKind,brand:t.brand,model:t.size,unit:t.unit,number:t.count,price:t.unitPrice,amount:t.count*parseFloat(t.unitPrice)})})}).catch(function(t){e.postErrorTip("请求失败"),console.log(t)})},showModifyModal:function(t){this.$router.push({path:"/editPutInOrder/"+t})},showDelModal:function(t){this.delModal=!0,this.delId=t,this.deleteForm.reason=""},deleteIntoWarehouseRecord:function(t,e){var o=this;BaseAxios({method:"post",url:"/sr/storeroomData!deleteIntoWarehouseRecord.action",data:{id:t,deleteCause:e}}).then(function(t){var e=t.data;""!==e&&o.postWarningTip(e),o.saveLoading=!1,o.getIntoWarehouseRecordPage(o.pageNum,o.pageSize,o.startDate,o.endDate,o.type,o.warehouse,o.supplier,o.orderNO)}).catch(function(t){o.saveLoading=!1,o.postErrorTip("请求失败"),console.log(t)})},handleSubmit:function(){this.saveLoading=!0,this.delModal=!1,this.deleteIntoWarehouseRecord(this.delId,this.deleteForm.reason)},getIntoWarehouseRecordPage:function(t,e,o,a,n,s,i,r){var l=this;this.data=[],BaseAxios({method:"post",url:"/sr/storeroomData!getIntoWarehouseRecordPage.action",data:{pageNum:t,pageSize:e,startDate:o,endDate:a,kindCode:n,storeroomId:s,goodsSupplierId:i,num:r}}).then(function(t){var e=t.data;e&&e.list.length>0&&e.list.map(function(t){l.data.push({id:t.id,putInOrder:t.num,putInDate:t.date,putInType:t.kind,warehouse:t.warehouseName,supplier:t.goodsSupplierName,number:t.goodsNum,orderPerson:t.user,orderDate:t.productDate,canEdit:t.canEdit})}),l.total=e.totalCount,l.selectLoading=!1}).catch(function(t){l.selectLoading=!1,l.postErrorTip("请求失败"),console.log(t)})},changePage:function(t){this.pageNum=t,this.getIntoWarehouseRecordPage(this.pageNum,this.pageSize,this.startDate,this.endDate,this.type,this.warehouse,this.supplier,this.orderNO)},changePageSize:function(t){this.pageSize=t,this.getIntoWarehouseRecordPage(this.pageNum,this.pageSize,this.startDate,this.endDate,this.type,this.warehouse,this.supplier,this.orderNO)},selectHandle:function(){this.selectLoading=!0,this.getIntoWarehouseRecordPage(this.pageNum,this.pageSize,this.startDate,this.endDate,this.type,this.warehouse,this.supplier,this.orderNO)}},mounted:function(){}},n=o("W5g0");var s=function(t){o("Ocqw")},i=Object(n.a)(a,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"zd-common-component"},[o("div",{staticClass:"zd-common-clearFix"},[o("Button",{staticClass:"zd-common-fl zd-common-pl11 zd-common-pr11 zd-common-mr10 zd-cm-res-fl",attrs:{type:"primary","custom-icon":"zd-common-icon-add"},on:{click:t.toAddOrder}},[t._v("\n      入库单\n    ")]),t._v(" "),o("div",{staticClass:"zd-common-fr zd-cm-res-fr"},[o("DatePicker",{staticClass:"zd-cm-w220 zd-common-input-h38 zd-common-fl zd-common-mr10",attrs:{editable:!1,type:"daterange",options:t.dateOptions,placeholder:"日期"},on:{"on-change":t.changeDate}}),t._v(" "),o("Select",{staticClass:"zd-common-w150 zd-common-mr10 zd-common-input-h38 zd-common-fl",attrs:{clearable:"",placeholder:"选择入库类型"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.typeArr,function(e){return o("Option",{key:e.code,attrs:{value:e.code}},[t._v(t._s(e.name))])}),1),t._v(" "),o("Select",{staticClass:"zd-common-w200 zd-common-mr10 zd-common-input-h38 zd-common-fl",attrs:{clearable:"",placeholder:"选择入库仓库"},model:{value:t.warehouse,callback:function(e){t.warehouse=e},expression:"warehouse"}},t._l(t.warehouseArr,function(e){return o("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1),t._v(" "),o("Select",{staticClass:"zd-common-w200 zd-common-mr10 zd-common-input-h38 zd-common-fl",attrs:{clearable:"",placeholder:"全部供应商"},model:{value:t.supplier,callback:function(e){t.supplier=e},expression:"supplier"}},t._l(t.supplierArr,function(e){return o("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1),t._v(" "),o("Input",{staticClass:"zd-common-input-h38 zd-common-w150 zd-common-fl zd-common-mr10",attrs:{maxlength:50,placeholder:"入库单号"},model:{value:t.orderNO,callback:function(e){t.orderNO=e},expression:"orderNO"}}),t._v(" "),o("Button",{staticClass:"zd-common-fl",attrs:{type:"primary",loading:t.selectLoading},on:{click:t.selectHandle}},[t.selectLoading?o("span",[t._v("正在查询...")]):o("span",[t._v("查询")])])],1)],1),t._v(" "),o("div",{staticClass:"zd-common-mt16"},[o("Table",{ref:"currentRowTable",attrs:{border:"",columns:t.columns,data:t.data}}),t._v(" "),o("div",{staticClass:"zd-common-tc zd-common-mt20"},[o("Page",{attrs:{total:t.total,current:t.pageNum,"page-size":t.pageSize,"show-sizer":"","show-elevator":"","show-total":""},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}})],1)],1),t._v(" "),o("Modal",{ref:"print",attrs:{"mask-closable":!1,width:1100},model:{value:t.viewModal,callback:function(e){t.viewModal=e},expression:"viewModal"}},[o("h3",{staticClass:"zd-common-modal-header",attrs:{slot:"header"},slot:"header"},[o("span",[t._v("查看入库单")])]),t._v(" "),o("div",{staticClass:"zd-common-clearFix"},[o("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("入库单号："),o("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.num))])]),t._v(" "),o("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("入库日期："),o("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.date))])]),t._v(" "),o("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("入库仓库："),o("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.warehouseName))])]),t._v(" "),o("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("入库类型："),o("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.kindCode))])]),t._v(" "),o("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("供应商："),o("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.goodsSupplierName))])]),t._v(" "),o("span",{staticClass:"zd-common-fl zd-common-mr14"},[t._v("采购人："),o("span",{staticClass:"zd-common-font-weight"},[t._v(t._s(t.allDetail.buyserName))])])]),t._v(" "),o("div",{staticClass:"zd-common-h300 zd-common-mt10"},[o("vue-scroll",[o("Table",{attrs:{border:"",columns:t.goodsCols,data:t.goodsData,"summary-method":t.handleSummary,"show-summary":""}})],1)],1),t._v(" "),o("div",{staticClass:"zd-common-mt10 zd-common-clearFix"},[o("span",{staticClass:"zd-common-fl"},[t._v("制单人："+t._s(t.allDetail.userName))]),o("span",{staticClass:"zd-common-fl zd-common-ml20"},[t._v("制单日期："+t._s(t.allDetail.productDate))])]),t._v(" "),o("div",{staticClass:"zd-common-mt10 zd-common-clearFix"},[o("span",{staticClass:"zd-common-clearFix"},[o("span",{staticClass:"zd-common-fl"},[t._v("备注：")]),o("span",{staticClass:"zd-common-fl zd-cm-remark"},[t._v(t._s(t.allDetail.note))])])]),t._v(" "),o("div",{staticClass:"zd-common-modal-footer zd-common-pt10",attrs:{slot:"footer"},slot:"footer"},[o("Button",{staticClass:"zd-common-mr35 zd-common-w100 zd-common-h32 zd-common-lh8",attrs:{type:"primary"},on:{click:t.printHandle}},[t._v("打印")]),t._v(" "),o("Button",{staticClass:"zd-common-w100 zd-common-h32 zd-common-lh8",on:{click:function(e){t.viewModal=!1}}},[t._v("取消")])],1)]),t._v(" "),o("Modal",{attrs:{"mask-closable":!1,width:590},model:{value:t.delModal,callback:function(e){t.delModal=e},expression:"delModal"}},[o("h3",{staticClass:"zd-common-modal-header",attrs:{slot:"header"},slot:"header"},[o("span",[t._v("删除入库单")])]),t._v(" "),o("Alert",{staticClass:"zd-common-warning-c",attrs:{type:"warning","show-icon":""}},[t._v("删除入库单将同步删除该入库单中所有已入库物品，导致数据统计错误，请谨慎操作！")]),t._v(" "),o("Form",{ref:"deleteForm",attrs:{model:t.deleteForm}},[o("FormItem",{staticClass:"zd-common-mb0",attrs:{label:"删除原因："}},[o("Input",{staticClass:"zd-common-fl",attrs:{placeholder:"",maxlength:100,type:"textarea",autosize:{minRows:3,maxRows:3}},model:{value:t.deleteForm.reason,callback:function(e){t.$set(t.deleteForm,"reason","string"==typeof e?e.trim():e)},expression:"deleteForm.reason"}})],1)],1),t._v(" "),o("div",{staticClass:"zd-common-modal-footer zd-common-pt10",attrs:{slot:"footer"},slot:"footer"},[o("Button",{staticClass:"zd-common-mr35 zd-common-w100 zd-common-h32 zd-common-lh8",attrs:{type:"primary",loading:t.saveLoading},on:{click:t.handleSubmit}},[t.saveLoading?o("span",[t._v("正在保存...")]):o("span",[t._v("确定")])]),t._v(" "),o("Button",{staticClass:"zd-common-w100 zd-common-h32 zd-common-lh8",on:{click:function(e){t.delModal=!1}}},[t._v("取消")])],1)],1)],1)},[],!1,s,"data-v-5ddee526",null);e.default=i.exports},Ocqw:function(t,e){}});
//# sourceMappingURL=24.cfc6df881571c5e50241.js.map