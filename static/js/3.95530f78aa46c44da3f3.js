webpackJsonp([3],{HzJ8:function(o,t,a){o.exports={default:a("P/sN"),__esModule:!0}},"P/sN":function(o,t,a){a("MJJS"),a("at0p"),o.exports=a("eBrH")},RPjs:function(o,t){},YAD3:function(o,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=a("HzJ8"),s=a.n(e),n=a("+RvV"),i={components:{ImportMsg:a("ZTjp").a},data:function(){var o=this;return{addModal:!1,oldCode:"",addForm:{name:"",code:"",contacts:"",phone:"",address:"",status:"0"},ruleValidate:{name:[{required:!0,message:"不能为空",trigger:"blur"}],code:[{required:!0,validator:function(t,a,e){""===a?e(new Error("不能为空")):n.c.regCode.test(a)?BaseAxios({method:"post",url:"/sr/storeroomData!validateGoodsSupplierCode.action",data:{validateValue:a,excludeValue:o.oldCode}}).then(function(o){o.data||e(new Error("编码重复")),e()}).catch(function(o){e(new Error("验证失败")),console.log(o)}):e(new Error(n.c.regCodeMsg))},trigger:"blur"}],status:[{required:!0,message:"不能为空",trigger:"change"}],fileName:[{required:!0,message:"请选择文件",trigger:"blur"}]},modalTitle:"添加供应商档案",visible:!1,uploadPicUrl:"",uploadScreenList:[],uploadIds:[],columns:[{type:"index",align:"center",title:"序号",width:65},{title:"供应商名称",align:"center",key:"name",render:function(t,a){return t("div",[t("span",{class:"zd-common-primary-c zd-common-cp",on:{click:function(){o.showViewModal(a.row.id)}}},a.row.name)])}},{title:"供应商编码",align:"center",key:"code"},{title:"联系人",align:"center",key:"contacts"},{title:"联系人电话",align:"center",key:"phone"},{title:"地址",align:"center",key:"address"},{title:"状态",align:"center",key:"status"},{title:"操作",align:"center",key:"action",width:160,render:function(t,a){return t("div",[t("Button",{props:{type:"primary",ghost:!0},style:{height:"28px",padding:"0 15px 1px",marginRight:"10px"},on:{click:function(){o.showEditModal(a.row.id)}}},"编辑"),t("Button",{props:{type:"error",ghost:!0},style:{height:"28px",padding:"0 15px 1px"},on:{click:function(){o.showDelModal(a.row.id)}}},"删除")])}}],data:[],pageSize:10,pageNum:1,total:0,selectLoading:!1,importModal:!1,importForm:{file:null,fileName:""},importErrorMsg:[],status:"0",name:"",saveLoading:!1,viewModal:!1,allDetail:{},editId:"",delModal:!1}},created:function(){this.getSupplierList(this.pageNum,this.pageSize,this.status,this.name)},methods:{transCode:function(){this.addForm.code=Object(n.b)(this.addForm.name)},showAddModal:function(){this.modalTitle="添加供应商档案",this.editId="",this.addModal=!0,this.uploadScreenList=[],this.uploadIds=[],this.$refs.addForm.resetFields(),this.addForm.contacts="",this.addForm.phone="",this.addForm.address=""},saveOrUpdateGoodsSupplier:function(o,t,a,e,s,n,i,r){var d=this;BaseAxios({method:"post",url:"/sr/storeroomData!saveOrUpdateGoodsSupplier.action",data:{"goodsSupplier.name":o,"goodsSupplier.code":t,"goodsSupplier.contacts":a,"goodsSupplier.phone":e,"goodsSupplier.address":s,"goodsSupplier.status":n,"goodsSupplier.id":r,attIds:i}}).then(function(o){d.saveLoading=!1,d.addModal=!1,d.getSupplierList(d.pageNum,d.pageSize,d.status,d.name),d.postSuccessTip("保存成功")}).catch(function(o){d.saveLoading=!1,d.addModal=!1,d.postErrorTip("请求失败"),console.log(o)})},handleSubmit:function(o){var t=this;this.$refs[o].validate(function(o){o&&(t.saveLoading=!0,t.saveOrUpdateGoodsSupplier(t.addForm.name,t.addForm.code,t.addForm.contacts,t.addForm.phone,t.addForm.address,t.addForm.status,t.uploadIds.join(","),t.editId))})},handleView:function(o){this.uploadPicUrl=o,this.visible=!0},handleRemove:function(o){this.uploadScreenList.splice(this.uploadIds.indexOf(o),1),this.uploadIds.splice(this.uploadIds.indexOf(o),1)},handleScreenSuccess:function(o,t){this.uploadIds.push(o.id),t.url=this.serverPath+"/sr/storeroomData!showTempPic.action?attachmentId="+o.id,t.id=o.id,this.uploadScreenList=this.$refs.uploadScreen.fileList},handleScreenFormatError:function(o){this.postWarningTip(o.name+"图片格式错误")},handleScreenMaxSize:function(o){this.postWarningTip(o.name+"图片太大","最多上传2M大小的图片")},handleBeforeUpload:function(o){var t=this.$refs.uploadScreen.fileList.length<5;if(t){var a=!0,e=!1,n=void 0;try{for(var i,r=s()(this.$refs.uploadScreen.fileList);!(a=(i=r.next()).done);a=!0){var d=i.value;if(o.name===d.name)return this.postWarningTip("图片已存在"),!1}}catch(o){e=!0,n=o}finally{try{!a&&r.return&&r.return()}finally{if(e)throw n}}}else this.postWarningTip("最多上传5张");return t},importHandle:function(){this.importErrorMsg=[],this.importModal=!0,this.$refs.importForm.resetFields(),this.importForm.file=null},handleUpload:function(o){return n.c.regImportType.test(o.name)?(this.importForm.file=o,this.importForm.fileName=o.name,this.$refs.importForm.validateField("fileName")):this.postWarningTip(n.c.regImportTypeMsg),!1},importSubmit:function(o){var t=this;this.$refs[o].validate(function(o){o&&(t.saveLoading=!0,t.validateImportGoodsSupplier())})},saveImport:function(){var o=this,t=new FormData;t.append("upload",this.importForm.file),BaseAxios({method:"post",url:"/sr/storeroomData!doImportGoodsSupplier.action",data:t,processData:!1,contentType:!1,transformRequest:[function(o){return o}]}).then(function(t){o.saveLoading=!1,o.importModal=!1,o.importForm.file=null,o.getSupplierList(o.pageNum,o.pageSize,o.status,o.name)}).catch(function(t){o.saveLoading=!1,o.importModal=!1,o.postErrorTip("请求失败"),o.$refs.upload.value="",console.log(t)})},validateImportGoodsSupplier:function(){var o=this,t=new FormData;t.append("upload",this.importForm.file),BaseAxios({method:"post",url:"/sr/storeroomData!validateImportGoodsSupplier.action",data:t,processData:!1,contentType:!1,transformRequest:[function(o){return o}]}).then(function(t){var a=t.data;o.importErrorMsg=a,a.length<=0?o.saveImport():o.saveLoading=!1}).catch(function(t){o.saveLoading=!1,o.postErrorTip("请求失败"),console.log(t)})},getSupplierList:function(o,t,a,e){var s=this;this.data=[],BaseAxios({method:"post",url:"/sr/storeroomData!getGoodsSupplierPage.action",data:{pageNum:o,pageSize:t,status:a,name:e}}).then(function(o){var t=o.data;t&&t.list.length>0&&t.list.map(function(o){s.data.push({id:o.id,name:o.name,code:o.code,contacts:o.contacts,phone:o.phone,address:o.address,status:o.statusName})}),s.total=t.totalCount,s.selectLoading=!1}).catch(function(o){s.selectLoading=!1,s.postErrorTip("请求失败"),console.log(o)})},changePage:function(o){this.pageNum=o,this.getSupplierList(this.pageNum,this.pageSize,this.status,this.name)},changePageSize:function(o){this.pageSize=o,this.getSupplierList(this.pageNum,this.pageSize,this.status,this.name)},selectHandle:function(){this.selectLoading=!0,this.getSupplierList(this.pageNum,this.pageSize,this.status,this.name)},showViewModal:function(o){this.viewModal=!0,this.getSupplierInfo(o)},getSupplierInfo:function(o){var t=this;BaseAxios({method:"post",url:"/sr/storeroomData!getGoodsSupplierInfo.action",data:{id:o}}).then(function(o){var a=o.data;t.allDetail=a,t.addForm.name=a.name,t.addForm.code=a.code,t.addForm.contacts=a.contacts,t.addForm.phone=a.phone,t.addForm.address=a.address,t.addForm.status=a.status,a.picList.map(function(o){t.uploadIds.push(o.id),t.uploadScreenList.push({id:o.id,url:t.serverPath+o.url,status:"finished"})})}).catch(function(o){t.postErrorTip("请求失败"),console.log(o)})},showEditModal:function(o){this.modalTitle="修改供应商档案",this.editId=o,this.addModal=!0,this.uploadScreenList=[],this.uploadIds=[],this.getSupplierInfo(o)},clearHandle:function(){this.$refs.addForm.resetFields(),this.addModal=!1},showDelModal:function(o){this.editId=o,this.delModal=!0},deleteGoodsSupplier:function(o){var t=this;BaseAxios({method:"post",url:"/sr/storeroomData!deleteGoodsSupplier.action",data:{id:o}}).then(function(o){o.data;t.getSupplierList(t.pageNum,t.pageSize,t.status,t.name)}).catch(function(o){t.postErrorTip("请求失败"),console.log(o)})},confirmDelHandle:function(){this.deleteGoodsSupplier(this.editId)}},mounted:function(){this.uploadScreenList=this.$refs.uploadScreen.fileList}},r=a("W5g0");var d=function(o){a("RPjs")},l=Object(r.a)(i,function(){var o=this,t=o.$createElement,a=o._self._c||t;return a("div",{staticClass:"zd-common-component"},[a("div",{staticClass:"zd-common-clearFix"},[a("Button",{staticClass:"zd-common-fl zd-common-pl11 zd-common-pr11 zd-common-mr10",attrs:{type:"primary","custom-icon":"zd-common-icon-add"},on:{click:o.showAddModal}},[o._v("\n      供应商档案\n    ")]),o._v(" "),a("Button",{staticClass:"zd-common-fl zd-common-pl11 zd-common-pr11 zd-common-mr10",attrs:{type:"primary","custom-icon":"zd-common-icon-import"},on:{click:o.importHandle}},[o._v("\n      导入\n    ")]),o._v(" "),a("div",{staticClass:"zd-common-fr"},[a("Select",{staticClass:"zd-common-input-h38 zd-common-w200 zd-common-fl zd-common-mr10",attrs:{placeholder:"状态",clearable:""},model:{value:o.status,callback:function(t){o.status=t},expression:"status"}},[a("Option",{attrs:{value:"0"}},[o._v("启用")]),o._v(" "),a("Option",{attrs:{value:"1"}},[o._v("禁用")])],1),o._v(" "),a("Input",{staticClass:"zd-common-input-h38 zd-common-w200 zd-common-fl zd-common-mr10",attrs:{placeholder:"供应商名称"},model:{value:o.name,callback:function(t){o.name=t},expression:"name"}}),o._v(" "),a("Button",{staticClass:"zd-common-fl",attrs:{type:"primary",loading:o.selectLoading},on:{click:o.selectHandle}},[o.selectLoading?a("span",[o._v("正在查询...")]):a("span",[o._v("查询")])])],1)],1),o._v(" "),a("div",{staticClass:"zd-common-mt16"},[a("Table",{ref:"currentRowTable",attrs:{border:"",columns:o.columns,data:o.data}}),o._v(" "),a("div",{staticClass:"zd-common-tc zd-common-mt20"},[a("Page",{attrs:{total:o.total,current:o.pageNum,"page-size":o.pageSize,"show-sizer":"","show-elevator":"","show-total":""},on:{"on-change":o.changePage,"on-page-size-change":o.changePageSize}})],1)],1),o._v(" "),a("Modal",{staticClass:"zd-cm-form",attrs:{"mask-closable":!1},on:{"on-cancel":o.clearHandle},model:{value:o.addModal,callback:function(t){o.addModal=t},expression:"addModal"}},[a("h3",{staticClass:"zd-common-modal-header",attrs:{slot:"header"},slot:"header"},[a("span",[o._v(o._s(o.modalTitle))])]),o._v(" "),a("Form",{ref:"addForm",attrs:{model:o.addForm,rules:o.ruleValidate,"label-width":110}},[a("FormItem",{attrs:{label:"供应商名称：",prop:"name"}},[a("Input",{staticClass:"zd-common-w300",attrs:{placeholder:"请输入供应商名称",maxlength:50},on:{"on-blur":o.transCode},model:{value:o.addForm.name,callback:function(t){o.$set(o.addForm,"name","string"==typeof t?t.trim():t)},expression:"addForm.name"}})],1),o._v(" "),a("FormItem",{attrs:{label:"供应商编码：",prop:"code"}},[a("Input",{staticClass:"zd-common-w300",attrs:{placeholder:"请输入供应商编码",maxlength:50},model:{value:o.addForm.code,callback:function(t){o.$set(o.addForm,"code","string"==typeof t?t.trim():t)},expression:"addForm.code"}})],1),o._v(" "),a("FormItem",{attrs:{label:"联系人："}},[a("Input",{staticClass:"zd-common-w300",attrs:{placeholder:"请输入联系人",maxlength:50},model:{value:o.addForm.contacts,callback:function(t){o.$set(o.addForm,"contacts","string"==typeof t?t.trim():t)},expression:"addForm.contacts"}})],1),o._v(" "),a("FormItem",{attrs:{label:"联系人电话："}},[a("Input",{staticClass:"zd-common-w300",attrs:{placeholder:"请输入联系人电话",maxlength:11},model:{value:o.addForm.phone,callback:function(t){o.$set(o.addForm,"phone","string"==typeof t?t.trim():t)},expression:"addForm.phone"}})],1),o._v(" "),a("FormItem",{attrs:{label:"地址：",prop:"address"}},[a("Input",{staticClass:"zd-common-w300",attrs:{placeholder:"请输入地址",maxlength:50},model:{value:o.addForm.address,callback:function(t){o.$set(o.addForm,"address","string"==typeof t?t.trim():t)},expression:"addForm.address"}})],1),o._v(" "),a("FormItem",{attrs:{label:"状态：",prop:"status"}},[a("Select",{staticClass:"zd-common-w300",attrs:{placeholder:"请选择状态"},model:{value:o.addForm.status,callback:function(t){o.$set(o.addForm,"status",t)},expression:"addForm.status"}},[a("Option",{attrs:{value:"0"}},[o._v("启用")]),o._v(" "),a("Option",{attrs:{value:"1"}},[o._v("禁用")])],1)],1),o._v(" "),a("FormItem",{attrs:{label:"资质文件："}},[o._l(o.uploadScreenList,function(t){return a("div",{staticClass:"demo-upload-list"},["finished"===t.status?[a("img",{attrs:{src:t.url}}),o._v(" "),a("div",{staticClass:"demo-upload-list-cover"},[a("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(a){return o.handleView(t.url)}}}),o._v(" "),a("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(a){return o.handleRemove(t.id)}}})],1)]:[t.showProgress?a("Progress",{attrs:{percent:t.percentage,"hide-info":""}}):o._e()]],2)}),o._v(" "),a("Upload",{ref:"uploadScreen",staticClass:"zd-common-w72 zd-common-dib",attrs:{multiple:"",name:"filedata","show-upload-list":!1,format:["jpg","jpeg","png"],type:"drag",action:o.serverPath+"/component/attachment!saveUploadFile2.action","max-size":2048,"on-success":o.handleScreenSuccess,"on-format-error":o.handleScreenFormatError,"on-exceeded-size":o.handleScreenMaxSize,"before-upload":o.handleBeforeUpload}},[a("div",{staticClass:"zd-common-w72 zd-common-h72 zd-common-lh72"},[a("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)]),o._v(" "),a("Modal",{attrs:{width:60},model:{value:o.visible,callback:function(t){o.visible=t},expression:"visible"}},[a("h3",{staticClass:"zd-common-modal-header",attrs:{slot:"header"},slot:"header"},[a("span",[o._v("预览资质")])]),o._v(" "),a("vue-scroll",[a("div",{staticClass:"zd-common-font-size-base zd-common-lh30 zd-common-tc zd-common-h500"},[o.visible?a("img",{staticStyle:{"max-width":"100%"},attrs:{src:o.uploadPicUrl}}):o._e()])]),o._v(" "),a("div",{staticClass:"zd-common-modal-footer zd-common-pt0",attrs:{slot:"footer"},slot:"footer"})],1)],2)],1),o._v(" "),a("div",{staticClass:"zd-common-modal-footer zd-common-pt0",attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"zd-common-mr35 zd-common-w100 zd-common-h32 zd-common-lh8",attrs:{type:"primary",loading:o.saveLoading},on:{click:function(t){return o.handleSubmit("addForm")}}},[o.saveLoading?a("span",[o._v("正在保存...")]):a("span",[o._v("确定")])]),o._v(" "),a("Button",{staticClass:"zd-common-w100 zd-common-h32 zd-common-lh8",on:{click:o.clearHandle}},[o._v("取消")])],1)],1),o._v(" "),a("Modal",{attrs:{"mask-closable":!1,width:360},model:{value:o.delModal,callback:function(t){o.delModal=t},expression:"delModal"}},[a("h3",{attrs:{slot:"header"},slot:"header"}),o._v(" "),a("div",{staticClass:"zd-common-tc"},[a("div",{staticClass:"zd-common-modal-waring zd-common-auto"}),o._v(" "),a("p",{staticClass:"zd-common-primary-c zd-common-font-size-large zd-common-mt15"},[o._v("是否确认删除？")])]),o._v(" "),a("div",{staticClass:"zd-common-modal-footer zd-common-pt10",attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"zd-common-mr24 zd-common-w100 zd-common-h32 zd-common-lh8",attrs:{type:"primary",loading:o.saveLoading},on:{click:o.confirmDelHandle}},[o.saveLoading?a("span",[o._v("正在删除...")]):a("span",[o._v("确定")])]),o._v(" "),a("Button",{staticClass:"zd-common-w100 zd-common-h32 zd-common-lh8",on:{click:function(t){o.delModal=!1}}},[o._v("取消")])],1)]),o._v(" "),a("Modal",{attrs:{"mask-closable":!1},model:{value:o.viewModal,callback:function(t){o.viewModal=t},expression:"viewModal"}},[a("h3",{staticClass:"zd-common-modal-header",attrs:{slot:"header"},slot:"header"},[a("span",[o._v("查看供应商档案")])]),o._v(" "),a("div",[a("p",{staticClass:"zd-common-mb20"},[a("span",{staticClass:"zd-common-dib zd-common-w100 zd-common-tr"},[o._v("供应商名称：")]),o._v("\n        "+o._s(o.allDetail.name)+"\n      ")]),o._v(" "),a("p",{staticClass:"zd-common-mb20"},[a("span",{staticClass:"zd-common-dib zd-common-w100 zd-common-tr"},[o._v("供应商编码：")]),o._v("\n        "+o._s(o.allDetail.code)+"\n      ")]),o._v(" "),a("p",{staticClass:"zd-common-mb20"},[a("span",{staticClass:"zd-common-dib zd-common-w100 zd-common-tr"},[o._v("联系人：")]),o._v("\n        "+o._s(o.allDetail.contacts)+"\n      ")]),o._v(" "),a("p",{staticClass:"zd-common-mb20"},[a("span",{staticClass:"zd-common-dib zd-common-w100 zd-common-tr"},[o._v("联系人电话：")]),o._v("\n        "+o._s(o.allDetail.phone)+"\n      ")]),o._v(" "),a("p",{staticClass:"zd-common-mb20"},[a("span",{staticClass:"zd-common-dib zd-common-w100 zd-common-tr"},[o._v("地址：")]),o._v("\n        "+o._s(o.allDetail.address)+"\n      ")]),o._v(" "),a("p",{staticClass:"zd-common-mb20"},[a("span",{staticClass:"zd-common-dib zd-common-w100 zd-common-tr"},[o._v("状态：")]),o._v("\n        "+o._s("0"===o.allDetail.status?"启用":"禁用")+"\n      ")]),o._v(" "),a("p",{staticClass:"zd-common-mb20"},[a("span",{staticClass:"zd-common-dib zd-common-w100 zd-common-tr"},[o._v("资质文件：")]),o._v(" "),o._l(o.allDetail.picList,function(t){return a("span",{key:t.id,staticClass:"zd-common-primary-c"},[o._v(o._s(t.name))])})],2)]),o._v(" "),a("div",{staticClass:"zd-common-modal-footer zd-common-pt10",attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"zd-common-w100 zd-common-h32 zd-common-lh8",attrs:{type:"primary"},on:{click:function(t){o.viewModal=!1}}},[o._v("确定")]),o._v(" "),a("Button",{staticClass:"zd-common-w100 zd-common-h32 zd-common-lh8",on:{click:function(t){o.viewModal=!1}}},[o._v("取消")])],1)]),o._v(" "),a("Modal",{attrs:{"mask-closable":!1},model:{value:o.importModal,callback:function(t){o.importModal=t},expression:"importModal"}},[a("h3",{staticClass:"zd-common-modal-header",attrs:{slot:"header"},slot:"header"},[a("span",[o._v("导入供应商档案")])]),o._v(" "),a("Form",{ref:"importForm",attrs:{model:o.importForm,rules:o.ruleValidate,"label-width":100,inline:""}},[a("FormItem",{attrs:{label:"上传文件：",prop:"fileName"}},[a("Upload",{ref:"upload",attrs:{action:"/sr/storeroomData!doImportGoodsSupplier.action",accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","before-upload":o.handleUpload}},[a("Button",{attrs:{type:"primary",icon:"ios-cloud-upload-outline"}},[o._v("选择文件")])],1),o._v(" "),null!==o.importForm.file?a("div",[o._v(" "+o._s(o.importForm.file.name)+" ")]):o._e(),o._v(" "),a("a",{attrs:{href:o.serverPath+"/sr/storeroomData!downloadGoodsSupplierTemplate.action"}},[o._v("下载模板")]),o._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:o.importForm.fileName,expression:"importForm.fileName"}],attrs:{type:"text",hidden:""},domProps:{value:o.importForm.fileName},on:{input:function(t){t.target.composing||o.$set(o.importForm,"fileName",t.target.value)}}})],1)],1),o._v(" "),a("import-msg",{attrs:{importErrorMsg:o.importErrorMsg}}),o._v(" "),a("div",{staticClass:"zd-common-modal-footer zd-common-pt10",attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"zd-common-mr35 zd-common-w100 zd-common-h32 zd-common-lh8",attrs:{type:"primary",loading:o.saveLoading},on:{click:function(t){return o.importSubmit("importForm")}}},[o.saveLoading?a("span",[o._v("正在保存...")]):a("span",[o._v("确定")])]),o._v(" "),a("Button",{staticClass:"zd-common-w100 zd-common-h32 zd-common-lh8",on:{click:function(t){o.importModal=!1}}},[o._v("取消")])],1)],1)],1)},[],!1,d,"data-v-20ec87c8",null);t.default=l.exports},eBrH:function(o,t,a){var e=a("xgeF"),s=a("PsHI");o.exports=a("ZuHZ").getIterator=function(o){var t=s(o);if("function"!=typeof t)throw TypeError(o+" is not iterable!");return e(t.call(o))}}});
//# sourceMappingURL=3.95530f78aa46c44da3f3.js.map